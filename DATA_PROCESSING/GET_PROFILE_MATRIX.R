######################################################################################################################################################
######################################################################################################################################################
# Cuvier's Lab
# David Depierre - Thomas De Freitas
######################################################################################################################################################
######################################################################################################################################################


########################################################
## ADD GENE NAMES ON MATRIX AND SAVE THEM IN R FORMAT
########################################################

### LIBRARY
library("IRanges")
library("GenomeInfoDb")
library("GenomicRanges")
library("S4Vectors")
library("stats4")
library("BiocGenerics")
library("parallel")


######################################################################################################################################################
### LOAD DATA
######################################################################################################################################################
filename = "filename"

ref_gene_gr = readRDS("PATH/TO/GENOME/REF")
file_outmatrix = as.matrix(read.table(paste0("PATH/TO/OUTPUT/FILE", filename,".outmatrix"), skip=3))
out_profmat_RDS = paste0("PATH/TO/OUTPUT/FILE", filename,"_profmat.RDS")

### ADD GENES ID to matrix as rownames
rownames(file_outmatrix) = paste0(names(ref_gene_gr),".1")
saveRDS(file_outmatrix, out_profmat_RDS)


# end
